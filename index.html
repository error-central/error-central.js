<html>

<!--
			Github issue: https://github.com/facebook/react/issues/16501
			SO question: https://stackoverflow.com/questions/47292727/react-uncaught-rangeerror-maximum-call-stack-size-exceeded
		-->

<head>
	<script src="./error-central.js" charset="utf-8"></script>

	<style>
		textarea {
			font-family: monospace;
			width: 500px;
			height: 50;
			text-align: left;
			background-color: black;
			color: white;
		}
	</style>

	<script>
		function fd(x) {
			x(5);
		}
		function fc(x) {
			fd(x);
		}
		function fb(x) {
			fc(x);
		}
		function fa(x) {
			fb(x);
		}

		function formEvalForError(f) {
			try {
				eval(f.elements["code"].value);
			} catch (e) {
				throw e; // intentionally re-throw (caught by window.onerror)
			}
		}

		function jsonTest() {
			try {
				return JSON.parse({ "balance": 0, "count": 0, "time": 1323973673061, "firstname": "howard", "userId": 5383, "localid": 1, "freeExpiration": 0, "status": false });
			} catch (e) {
				throw e; // intentionally re-throw (caught by window.onerror)
			}
		}



	</script>
</head>

<body>

	<script>
		doGithub = false;
		doEc = false;
		doSoGeneric = false;
		doDependencies = false;
		doSo = false;
	</script>

	<h1>Re-thinking Error messages and automating good engineers
		<!-- : Demo of Error Central for javascript -->
	</h1>




	<p>The Github repo for this demo is <a href="https://github.com/error-central/error-central.js">here</a>.</p>

	<h2>Error should link to docs</h2>
	<p>
		A small improvement would be to simply connect errors to the web. For now, let's just give the user a link to the
		official docs for the error. Better yet, link to the docs in the user's language.
	</p>
	<form>
		<textarea name="code">
undefinedFunction(4)
			</textarea>
		<input type="button" onclick="formEvalForError(this.form);" value="Execute" />
	</form>


	<h2>Automatically search Stack Overflow</h2>
	<p>It's an open secret that the first thing you do when you get an error is to search for it. So why are developers
		manually selecting text and copy-pasting it into Google? We know that 90% of the time we're going to end up on Stack
		Overflow, so let's automatically search there.
	</p>
	<form>
		<textarea name="code">
if (3 > Math.PI {
	console.log("wait what?");
}
		</textarea>
		<input type="button" onclick="doSo=true; formEvalForError(this.form);" value="Execute" />
	</form>

	<h2>...But be smart when searching</h2>
	<p>
		Any developer knows when to strip out details that are specific to their code. Our system should be smart enough to
		do
		this too. Of course, there are times when these little details are important, for example when the error happens in
		a
		specific line of a dependency. So the right thing to do is to search for both the exact text and for a "generic"
		version.
	</p>

	<form>
		<textarea name="code">
undefinedFunction(4)
			</textarea>
		<input type="button" onclick="doSo=true; doSoGeneric=true; formEvalForError(this.form);" value="Execute" />
	</form>


	<h2>Search known issues</h2>
	<p>
		Sometimes the error you're having is a known issue with your repo. Wouldn't it be great to know that right away? So
		let's also search the repo issues and wiki!
	</p>

	<form>
		<textarea name="code">
undefinedFunction(4)
					</textarea>
		<input type="button" onclick="doSo=true; doSoGeneric=true; doGithub=true; formEvalForError(this.form);"
			value="Execute" />
	</form>

	<p>
		And while we're at it: If there is no open issue for our error, let's provide a quick link to create one!
	</p>

	<form>
		<textarea name="code">
aDifferentUndefinedFunction(4)
						</textarea>
		<input type="button" onclick="doSo=true; doSoGeneric=true; doGithub=true; formEvalForError(this.form);"
			value="Execute" />
	</form>














	<hr>

	<!--
	<p>Buttons on this page produce errors. Open the browser console Command-Option-J to view console.</p>

	<button onclick="x=undefinedFunction(4)"><code>undefinedFunction(4)</code></button>


	<button onclick="x=undefinedFunction(4)"><code>undefinedFunction(4)</code></button>

	<button onclick="x=undefinedFunctionNoIssue(4)"><code>undefinedFunctionNoIssue()</code></button>

	<button onclick="Array.apply(null, new Array(1000000)).map(Math.random);"><code>RangeError</code></button>

	<button onclick='jsonTest()'>
		<code>JSON.parse()</code>
	</button>

	<button onclick="fa(4)"><code>Stack Function</code></button>

	<form>
		<textarea name="code">randomFunction();</textarea>
		<input type="button" onclick="formEvalForError(this.form);" value="Execute" />
	</form>
 -->


	<h2>Background</h2>
	<p>
		Its an open secret these days that software development consists of a lot of
		"run code", "get error", "copy-paste-error to google", "open top Stack Overflow link".
	</p>
	<p>
		<em>Good</em> developers know meta-search skills like removing code-specific
		function and variable names or recognizing when the results are too general.
		They know when to add a dependency to the search, or perhaps a bit of the stack trace.
	</p>
	<p>
		<em>Experienced</em> developers know when they are out of options, and will
		"escalate" to asking co-workers/co-contributers on Slack. "Has anyone seen
		this error before?"
	</p>

	<h2>What is this?</h2>

	<p>
		This repot is a "concept car" of what error messages could be. We hope it will spur
		interest and perhaps this can become a real tool someday. This works for
		javascript errors in Chrome or Firefox, but these ideas could be extended to
		anywhere errors appear
	</p>

	<p>
		We have also built basic versions of this functionality as a
		<a href="https://github.com/error-central/error-central/tree/master/vscode-extension">
			plugin for VS Code</a>, and directly in the terminal (bash).
	</p>

	<h2>Fundamentals</h2>
	<pre>
		- Deeper description of error from official docs
			- Ideal world there'd be some standard so that any package (e.g. react)
			  could publish error info. But for now we do it by hand.
		- Where possible, error description in developers native language (esp
		  important for beginnerin developers)
			- '<em>"0"-prefixed octal literals and octal escape seq. are deprecated</em>' is a
			  tough English sentance for a non-native speaker.
	</pre>

	<h2>Automate actions good devs do already</h2>
	<pre>
		- Search google. 80% of the time land on stackoverflow
			- Including long-shot searches that a coder would only do
			- Remove code-specific parts of error that would be irrelevant,
			  e.g. "myFunnyVariableName"
		- Search open issues for the project
			- If some other dev has reported the problem, know it immediately.
		- Search dependencies
			- Use stack trace to infer what dependency might be culpre
			- Serach open issues for dependencies
			- Extend serach to issues for dependencies, even going down entire
			  dependency textarea
		- Search with stack trace
		- OVERALL: know what a "good" result looks like.
			- A match with stack trace is better than one just for general type of error
	</pre>

	<h2>Analytics and sociality</h2>
	<pre>
		- Record errors and context.
		- Has this error been spiking worldwide in the last 24 hours? (Maybe a
		  dependency had a botched upgrade.)
		- Basic analytics on error freqency and first occurance. (a la Sentry)
		- Who of my co-workers/co-contributors has seen this error?
			- Especially if with same/similar stack trace / branch
	</pre>

	<h2>Machine Learning</h2>
	<pre>
		- We can also go <em>beyond</em> automating developer behavior.
		- Instead of naive text matching search, use the full context of an error
			when searching for relevant answers, issues, people.
			- Repo / branch
			- Stack trace
			- Dependencies
			- Input/launch configurations
		- Use the logging info to record the total context of an error. Then when
			the error happens later for someone else, they can know who to talk to, or
			even automatically see what worked to fix it.
	</pre>

</body>

</html>
